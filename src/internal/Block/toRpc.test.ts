import { Block } from 'ox'
import { expect, test } from 'vitest'

test('default', () => {
  const block = Block.toRpc({
    baseFeePerGas: 0n,
    blobGasUsed: 1n,
    difficulty: 12730590371363483n,
    excessBlobGas: 2n,
    extraData: '0x',
    gasLimit: 29999943n,
    gasUsed: 0n,
    hash: '0xebc3644804e4040c0a74c5a5bbbc6b46a71a5d4010fe0c92ebb2fdf4a43ea5dd',
    logsBloom:
      '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
    miner: '0x0000000000000000000000000000000000000000',
    mixHash:
      '0x0000000000000000000000000000000000000000000000000000000000000000',
    nonce: '0x0000000000000000',
    number: 15495110n,
    parentBeaconBlockRoot: undefined,
    parentHash:
      '0xe55516ad8029e53cd32087f14653d851401b05245abb1b2d6ed4ddcc597ac5a6',
    receiptsRoot:
      '0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421',
    sealFields: [
      '0x0000000000000000000000000000000000000000000000000000000000000000',
      '0x0000000000000000',
    ],
    sha3Uncles:
      '0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347',
    size: 520n,
    stateRoot:
      '0x0000000000000000000000000000000000000000000000000000000000000000',
    timestamp: 1662619503n,
    totalDifficulty: 1n,
    transactions: [
      {
        accessList: [],
        blockHash:
          '0x0c3e51fc62e1dd7401c8884882755b72e1c5720d0b01c75443cdfa8a129d3fc9',
        blockNumber: 19868020n,
        chainId: 1,
        data: '0x030102553e9c493678d8606d6a5ba284643db2110df8230040150000000000000000000000daa0e9d3ba85490000006401ae78736cd615f374d3085123a210448e74fc6393c02aaa39b223fe8d0a0e5c4f27ead9083c756cc202e590f497df75e26b99774030e1592a27c3e54a91dffc8d8c7ad7df808906ea64992a25297e17000000000000000000000000cc3d76219d81b15491f32a217206fda8e0f4982a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ae78736cd615f374d3085123a210448e74fc6393000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000c5abae0c91f1ee00000000000000000000000000000000000000000000000000c9c9d12f33719d8a8000000000000000000000e647457cf40066434f0e00000000000000000000469be304682ad55c57aeb258f271eeebd9e81277e3b53955fcf42a134c0b947477322c96c6a6a2d43120b9f8a661ff8cee8b27a146962f39b377d71cff6eb12b00000000000000000000000000000000000000000000000000c5abae0c91f1eea80000e1000015000000000000000000000000000000000000d276d30606c1e400000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000010a553e9c493678d8606d6a5ba284643db2110df823000000c1000000540000005400000054000000540000002a0000000000000000fb2809a5314473e1165f6b58018e20ed8f07b840065e8a0000234c66434e4e0000b40cbbf4065e8a00b4fb2809a5314473e1165f6b58018e20ed8f07b840065e8a0000234c66434e4e0000b40cbbf4065e8a00b4fb2809a5314473e1165f6b58018e20ed8f07b84066434e36b09498030ae3416b66dc00007bf29735c20c566e5a0c00000c989d73cf0bd5f83b660000d18bd45f0b94f54a968f0000d61b892b2ad6249011850000a59ca88d5813e693528f0000299aad897099c9fc85ce000038d42b0ecf8a9f8ba9db7b0c989d73cf0bd5f83b660300000000000000000000000000000000000000000000',
        from: '0x0ff82acd0cd11bff58729e7dc9cdcdbe1fcf7a74',
        gas: 690100n,
        hash: '0x6c4e8a1e9484ad717ef42df12a6cb9655216b6a2f7420f52dc540ed952860fdb',
        input:
          '0x030102553e9c493678d8606d6a5ba284643db2110df8230040150000000000000000000000daa0e9d3ba85490000006401ae78736cd615f374d3085123a210448e74fc6393c02aaa39b223fe8d0a0e5c4f27ead9083c756cc202e590f497df75e26b99774030e1592a27c3e54a91dffc8d8c7ad7df808906ea64992a25297e17000000000000000000000000cc3d76219d81b15491f32a217206fda8e0f4982a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ae78736cd615f374d3085123a210448e74fc6393000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000c5abae0c91f1ee00000000000000000000000000000000000000000000000000c9c9d12f33719d8a8000000000000000000000e647457cf40066434f0e00000000000000000000469be304682ad55c57aeb258f271eeebd9e81277e3b53955fcf42a134c0b947477322c96c6a6a2d43120b9f8a661ff8cee8b27a146962f39b377d71cff6eb12b00000000000000000000000000000000000000000000000000c5abae0c91f1eea80000e1000015000000000000000000000000000000000000d276d30606c1e400000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000010a553e9c493678d8606d6a5ba284643db2110df823000000c1000000540000005400000054000000540000002a0000000000000000fb2809a5314473e1165f6b58018e20ed8f07b840065e8a0000234c66434e4e0000b40cbbf4065e8a00b4fb2809a5314473e1165f6b58018e20ed8f07b840065e8a0000234c66434e4e0000b40cbbf4065e8a00b4fb2809a5314473e1165f6b58018e20ed8f07b84066434e36b09498030ae3416b66dc00007bf29735c20c566e5a0c00000c989d73cf0bd5f83b660000d18bd45f0b94f54a968f0000d61b892b2ad6249011850000a59ca88d5813e693528f0000299aad897099c9fc85ce000038d42b0ecf8a9f8ba9db7b0c989d73cf0bd5f83b660300000000000000000000000000000000000000000000',
        maxFeePerGas: 10483885608n,
        maxPriorityFeePerGas: 10483885608n,
        nonce: 5605n,
        r: 48548894853377191393229998580111995791186108897022932938401107173191692765603n,
        s: 25081418149156968932126781864579158719689112603561985214464814356390485145801n,
        to: '0xd42b0ecf8a9f8ba9db7b0c989d73cf0bd5f83b66',
        transactionIndex: 12,
        type: 'eip1559',
        v: 27,
        value: 21n,
        yParity: 0,
      },
    ],
    transactionsRoot:
      '0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421',
    uncles: [],
    withdrawals: [
      {
        address: '0xb9d7934878b5fb9610b3fe8a5e441e8fad7e293f',
        amount: 18611031n,
        index: 45328942,
        validatorIndex: 221976,
      },
    ],
    withdrawalsRoot:
      '0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421',
  })
  expect(block).toMatchInlineSnapshot(`
    {
      "baseFeePerGas": "0x00",
      "blobGasUsed": "0x01",
      "difficulty": "0x2d3a678cddba9b",
      "excessBlobGas": "0x02",
      "extraData": "0x",
      "gasLimit": "0x01c9c347",
      "gasUsed": "0x00",
      "hash": "0xebc3644804e4040c0a74c5a5bbbc6b46a71a5d4010fe0c92ebb2fdf4a43ea5dd",
      "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
      "miner": "0x0000000000000000000000000000000000000000",
      "mixHash": "0x0000000000000000000000000000000000000000000000000000000000000000",
      "nonce": "0x0000000000000000",
      "number": "0xec6fc6",
      "parentBeaconBlockRoot": undefined,
      "parentHash": "0xe55516ad8029e53cd32087f14653d851401b05245abb1b2d6ed4ddcc597ac5a6",
      "receiptsRoot": "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
      "sealFields": [
        "0x0000000000000000000000000000000000000000000000000000000000000000",
        "0x0000000000000000",
      ],
      "sha3Uncles": "0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",
      "size": "0x0208",
      "stateRoot": "0x0000000000000000000000000000000000000000000000000000000000000000",
      "timestamp": "0x63198f6f",
      "totalDifficulty": "0x01",
      "transactions": [
        {
          "accessList": [],
          "blockHash": "0x0c3e51fc62e1dd7401c8884882755b72e1c5720d0b01c75443cdfa8a129d3fc9",
          "blockNumber": "0x012f2974",
          "chainId": "0x01",
          "data": "0x030102553e9c493678d8606d6a5ba284643db2110df8230040150000000000000000000000daa0e9d3ba85490000006401ae78736cd615f374d3085123a210448e74fc6393c02aaa39b223fe8d0a0e5c4f27ead9083c756cc202e590f497df75e26b99774030e1592a27c3e54a91dffc8d8c7ad7df808906ea64992a25297e17000000000000000000000000cc3d76219d81b15491f32a217206fda8e0f4982a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ae78736cd615f374d3085123a210448e74fc6393000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000c5abae0c91f1ee00000000000000000000000000000000000000000000000000c9c9d12f33719d8a8000000000000000000000e647457cf40066434f0e00000000000000000000469be304682ad55c57aeb258f271eeebd9e81277e3b53955fcf42a134c0b947477322c96c6a6a2d43120b9f8a661ff8cee8b27a146962f39b377d71cff6eb12b00000000000000000000000000000000000000000000000000c5abae0c91f1eea80000e1000015000000000000000000000000000000000000d276d30606c1e400000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000010a553e9c493678d8606d6a5ba284643db2110df823000000c1000000540000005400000054000000540000002a0000000000000000fb2809a5314473e1165f6b58018e20ed8f07b840065e8a0000234c66434e4e0000b40cbbf4065e8a00b4fb2809a5314473e1165f6b58018e20ed8f07b840065e8a0000234c66434e4e0000b40cbbf4065e8a00b4fb2809a5314473e1165f6b58018e20ed8f07b84066434e36b09498030ae3416b66dc00007bf29735c20c566e5a0c00000c989d73cf0bd5f83b660000d18bd45f0b94f54a968f0000d61b892b2ad6249011850000a59ca88d5813e693528f0000299aad897099c9fc85ce000038d42b0ecf8a9f8ba9db7b0c989d73cf0bd5f83b660300000000000000000000000000000000000000000000",
          "from": "0x0ff82acd0cd11bff58729e7dc9cdcdbe1fcf7a74",
          "gas": "0x0a87b4",
          "hash": "0x6c4e8a1e9484ad717ef42df12a6cb9655216b6a2f7420f52dc540ed952860fdb",
          "input": "0x030102553e9c493678d8606d6a5ba284643db2110df8230040150000000000000000000000daa0e9d3ba85490000006401ae78736cd615f374d3085123a210448e74fc6393c02aaa39b223fe8d0a0e5c4f27ead9083c756cc202e590f497df75e26b99774030e1592a27c3e54a91dffc8d8c7ad7df808906ea64992a25297e17000000000000000000000000cc3d76219d81b15491f32a217206fda8e0f4982a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ae78736cd615f374d3085123a210448e74fc6393000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000c5abae0c91f1ee00000000000000000000000000000000000000000000000000c9c9d12f33719d8a8000000000000000000000e647457cf40066434f0e00000000000000000000469be304682ad55c57aeb258f271eeebd9e81277e3b53955fcf42a134c0b947477322c96c6a6a2d43120b9f8a661ff8cee8b27a146962f39b377d71cff6eb12b00000000000000000000000000000000000000000000000000c5abae0c91f1eea80000e1000015000000000000000000000000000000000000d276d30606c1e400000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000000000010a553e9c493678d8606d6a5ba284643db2110df823000000c1000000540000005400000054000000540000002a0000000000000000fb2809a5314473e1165f6b58018e20ed8f07b840065e8a0000234c66434e4e0000b40cbbf4065e8a00b4fb2809a5314473e1165f6b58018e20ed8f07b840065e8a0000234c66434e4e0000b40cbbf4065e8a00b4fb2809a5314473e1165f6b58018e20ed8f07b84066434e36b09498030ae3416b66dc00007bf29735c20c566e5a0c00000c989d73cf0bd5f83b660000d18bd45f0b94f54a968f0000d61b892b2ad6249011850000a59ca88d5813e693528f0000299aad897099c9fc85ce000038d42b0ecf8a9f8ba9db7b0c989d73cf0bd5f83b660300000000000000000000000000000000000000000000",
          "maxFeePerGas": "0x0270e36628",
          "maxPriorityFeePerGas": "0x0270e36628",
          "nonce": "0x15e5",
          "r": "0x6b55b361fe0329871a1654ba2c6bf4174aa8cffaa69dc912e36f2b5a722ec9a3",
          "s": "0x37739460ab0ca1c2007b48d1442601ac1bae40957ceaf7212966f857af6fb8c9",
          "to": "0xd42b0ecf8a9f8ba9db7b0c989d73cf0bd5f83b66",
          "transactionIndex": "0x0c",
          "type": "0x2",
          "value": "0x15",
          "yParity": "0x0",
        },
      ],
      "transactionsRoot": "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
      "uncles": [],
      "withdrawals": [
        {
          "address": "0xb9d7934878b5fb9610b3fe8a5e441e8fad7e293f",
          "amount": "0x011bfb57",
          "index": "0x02b3aa2e",
          "validatorIndex": "0x036318",
        },
      ],
      "withdrawalsRoot": "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
    }
  `)
})

test('behavior: nullish values', () => {
  const block = Block.toRpc({
    baseFeePerGas: undefined,
    blobGasUsed: undefined,
    difficulty: undefined,
    excessBlobGas: undefined,
    extraData: '0x',
    gasLimit: 0n,
    gasUsed: 0n,
    hash: '0xebc3644804e4040c0a74c5a5bbbc6b46a71a5d4010fe0c92ebb2fdf4a43ea5dd',
    logsBloom:
      '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',
    miner: '0x0000000000000000000000000000000000000000',
    mixHash:
      '0x0000000000000000000000000000000000000000000000000000000000000000',
    nonce: '0x0000000000000000',
    number: null,
    parentBeaconBlockRoot: undefined,
    parentHash:
      '0xe55516ad8029e53cd32087f14653d851401b05245abb1b2d6ed4ddcc597ac5a6',
    receiptsRoot:
      '0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421',
    sealFields: [
      '0x0000000000000000000000000000000000000000000000000000000000000000',
      '0x0000000000000000',
    ],
    sha3Uncles:
      '0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347',
    size: 0n,
    stateRoot:
      '0x0000000000000000000000000000000000000000000000000000000000000000',
    timestamp: 0n,
    transactions: [
      '0x6c4e8a1e9484ad717ef42df12a6cb9655216b6a2f7420f52dc540ed952860fdb',
    ],
    transactionsRoot:
      '0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421',
    uncles: [],
    withdrawals: [],
    withdrawalsRoot:
      '0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421',
  })
  expect(block).toMatchInlineSnapshot(`
    {
      "baseFeePerGas": undefined,
      "blobGasUsed": undefined,
      "difficulty": undefined,
      "excessBlobGas": undefined,
      "extraData": "0x",
      "gasLimit": "0x00",
      "gasUsed": "0x00",
      "hash": "0xebc3644804e4040c0a74c5a5bbbc6b46a71a5d4010fe0c92ebb2fdf4a43ea5dd",
      "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
      "miner": "0x0000000000000000000000000000000000000000",
      "mixHash": "0x0000000000000000000000000000000000000000000000000000000000000000",
      "nonce": "0x0000000000000000",
      "number": null,
      "parentBeaconBlockRoot": undefined,
      "parentHash": "0xe55516ad8029e53cd32087f14653d851401b05245abb1b2d6ed4ddcc597ac5a6",
      "receiptsRoot": "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
      "sealFields": [
        "0x0000000000000000000000000000000000000000000000000000000000000000",
        "0x0000000000000000",
      ],
      "sha3Uncles": "0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",
      "size": "0x00",
      "stateRoot": "0x0000000000000000000000000000000000000000000000000000000000000000",
      "timestamp": "0x00",
      "totalDifficulty": undefined,
      "transactions": [
        "0x6c4e8a1e9484ad717ef42df12a6cb9655216b6a2f7420f52dc540ed952860fdb",
      ],
      "transactionsRoot": "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
      "uncles": [],
      "withdrawals": [],
      "withdrawalsRoot": "0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",
    }
  `)
})
